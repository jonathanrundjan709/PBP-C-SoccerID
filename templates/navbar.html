<header class="sticky top-0 z-40 w-full border-b bg-white/95 backdrop-blur shadow-sm">
  <nav class="container mx-auto flex items-center justify-between py-4 px-6 relative">
    <a href="{% url 'main:show_main' %}" class="font-extrabold text-2xl text-brand tracking-tight">
      Soccer<span class="text-brand-dark">ID</span>
    </a>

    <button id="nav-toggle"
            class="md:hidden inline-flex flex-col justify-between w-8 h-6 p-1 border rounded-lg bg-white"
            aria-controls="nav-menu"
            aria-expanded="false"
            aria-label="Toggle navigation">
      <span class="block w-full h-0.5 bg-slate-800"></span>
      <span class="block w-full h-0.5 bg-slate-800"></span>
      <span class="block w-full h-0.5 bg-slate-800"></span>
    </button>

    <ul id="nav-menu"
        class="hidden
               absolute left-0 right-0 top-full z-30
               mx-0 bg-white border-b border-slate-200 shadow-md
               flex-col gap-2 p-4
               md:static md:flex md:flex-row md:items-center md:gap-6 md:p-0 md:shadow-none md:border-0 md:bg-transparent">
      <li><a href="{% url 'main:show_main' %}" class="block px-2 py-2 hover:text-brand-dark transition">Home</a></li>
      {% if user.is_authenticated %}
        <li class="px-2 py-2 text-slate-600">Hi, <span class="font-semibold">{{ user.username }}</span></li>
        <li>
          <button onclick="handleLogout()"
             class="block w-full text-left px-4 py-2 rounded-lg bg-brand text-white hover:bg-brand-dark transition">
             Logout
          </button>
        </li>
      {% else %}
        <li>
          <a href="{% url 'main:login' %}"
             class="block px-4 py-2 rounded-lg bg-brand text-white hover:bg-brand-dark transition">
             Login
          </a>
        </li>
        <li>
          <a href="{% url 'main:register' %}"
             class="block px-4 py-2 border rounded-lg hover:bg-brand-light/30 transition">
             Register
          </a>
        </li>
      {% endif %}
    </ul>
  </nav>
</header>

<script>
  (function () {
    const btn  = document.getElementById('nav-toggle');
    const menu = document.getElementById('nav-menu');

    if (!btn || !menu) return;

    btn.addEventListener('click', function (e) {
      e.stopPropagation();
      const hidden = menu.classList.toggle('hidden');
      btn.setAttribute('aria-expanded', String(!hidden));
    });

    document.addEventListener('click', function (e) {
      if (!menu.classList.contains('hidden')
          && !menu.contains(e.target)
          && !btn.contains(e.target)) {
        menu.classList.add('hidden');
        btn.setAttribute('aria-expanded', 'false');
      }
    });

    const mq = window.matchMedia('(min-width: 768px)');
    const syncMenu = () => {
      if (mq.matches) {
        menu.classList.remove('hidden');
        btn.setAttribute('aria-expanded', 'true');
      } else {
        menu.classList.add('hidden');
        btn.setAttribute('aria-expanded', 'false');
      }
    };
    syncMenu();
    mq.addEventListener ? mq.addEventListener('change', syncMenu) : mq.addListener(syncMenu);
  })();
</script>